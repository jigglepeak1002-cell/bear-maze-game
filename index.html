<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<!-- HARD LOCK MOBILE ZOOM & SCROLL -->
<meta name="viewport"
      content="width=device-width,
               height=device-height,
               initial-scale=1.0,
               maximum-scale=1.0,
               minimum-scale=1.0,
               user-scalable=no">

<title>Bear Maze â€“ Mobile Locked</title>

<style>
/* -------- HARD RESET FOR MOBILE -------- */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  touch-action: none;      /* stops browser gestures */
  -webkit-user-select: none;
  user-select: none;
}

html, body {
  width: 100%;
  height: 100%;
  overflow: hidden;        /* stops scrolling */
  background: #000;
  overscroll-behavior: none;
  position: fixed;
}

/* -------- GAME LAYOUT -------- */
#game {
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

#canvasWrapper {
  flex: 1;
  position: relative;
  width: 100%;
}

#bg {
  position: absolute;
  inset: 0;
  background: url("assets/jungle.png") center / cover no-repeat;
  filter: blur(2px);
}

canvas {
  position: absolute;
  inset: 0;
}

/* -------- CONTROLS -------- */
#controls {
  height: 35vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #111;
}

#dpad {
  display: grid;
  grid-template-columns: 90px 90px 90px;
  grid-template-rows: 90px 90px 90px;
  gap: 10px;
}

#dpad button {
  width: 90px;
  height: 90px;
  font-size: 36px;
  border-radius: 16px;
  border: none;
  background: #222;
  color: #fff;
}

#dpad button:active {
  background: #555;
}

.empty {
  background: transparent !important;
}
</style>
</head>

<body>

<div id="game">

  <div id="canvasWrapper">
    <div id="bg"></div>
    <canvas id="canvas"></canvas>
  </div>

  <div id="controls">
    <div id="dpad">
      <div class="empty"></div>
      <button data-dir="up">â¬†</button>
      <div class="empty"></div>

      <button data-dir="left">â¬…</button>
      <div class="empty"></div>
      <button data-dir="right">âž¡</button>

      <div class="empty"></div>
      <button data-dir="down">â¬‡</button>
      <div class="empty"></div>
    </div>
  </div>

</div>

<script>
/* -------- CANVAS SETUP -------- */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight * 0.65;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

/* -------- GAME CONFIG -------- */
const GRID = 23;                 // harder maze
const TILE = () => canvas.width / GRID;
const BEAR_SIZE = () => TILE() * 1.4;
const MOTHER_SIZE = () => TILE() * 1.6;
const SAFE_RADIUS = 4;

/* -------- MAZE -------- */
let maze = Array.from({ length: GRID }, () => Array(GRID).fill(1));

function carve(x, y) {
  maze[y][x] = 0;
  const dirs = [[2,0],[-2,0],[0,2],[0,-2]].sort(() => Math.random() - 0.5);
  for (const [dx, dy] of dirs) {
    const nx = x + dx, ny = y + dy;
    if (nx > 0 && ny > 0 && nx < GRID-1 && ny < GRID-1 && maze[ny][nx] === 1) {
      maze[y + dy/2][x + dx/2] = 0;
      carve(nx, ny);
    }
  }
}
carve(1,1);

function dist(x,y,a,b){ return Math.abs(x-a)+Math.abs(y-b); }

/* -------- OBSTACLES (NOT NEAR START) -------- */
for (let y=1;y<GRID-1;y++){
  for (let x=1;x<GRID-1;x++){
    if (maze[y][x]===0){
      let open=0;
      [[1,0],[-1,0],[0,1],[0,-1]].forEach(([dx,dy])=>{
        if(maze[y+dy][x+dx]===0) open++;
      });
      if(open===1 &&
         dist(x,y,1,1)>SAFE_RADIUS &&
         dist(x,y,GRID-2,GRID-2)>SAFE_RADIUS &&
         Math.random()<0.85){
        maze[y][x]=2;
      }
    }
  }
}

maze[1][1]=0;
maze[GRID-2][GRID-2]=0;

/* -------- PLAYER -------- */
const player={x:1,y:1};
const mother={x:GRID-2,y:GRID-2};

const bearImg=new Image();
bearImg.src="assets/bear.png";
const motherImg=new Image();
motherImg.src="assets/mother.png";

/* -------- DRAW -------- */
function drawMaze(){
  for(let y=0;y<GRID;y++){
    for(let x=0;x<GRID;x++){
      if(maze[y][x]===1){
        ctx.fillStyle="#111";
        ctx.fillRect(x*TILE(),y*TILE(),TILE(),TILE());
      }
      if(maze[y][x]===2){
        ctx.fillStyle="#c00000";
        ctx.beginPath();
        ctx.arc(
          x*TILE()+TILE()/2,
          y*TILE()+TILE()/2,
          TILE()/3,
          0,Math.PI*2
        );
        ctx.fill();
      }
    }
  }
}

function drawSprites(){
  ctx.drawImage(
    bearImg,
    player.x*TILE()-TILE()*0.2,
    player.y*TILE()-TILE()*0.2,
    BEAR_SIZE(),
    BEAR_SIZE()
  );
  ctx.drawImage(
    motherImg,
    mother.x*TILE()-TILE()*0.3,
    mother.y*TILE()-TILE()*0.3,
    MOTHER_SIZE(),
    MOTHER_SIZE()
  );
}

/* -------- MOVE -------- */
function move(dx,dy){
  const nx=player.x+dx;
  const ny=player.y+dy;
  const cell=maze[ny]?.[nx];
  if(cell===1||cell===undefined)return;
  if(cell===2){
    alert("ðŸ’¥ Wrong path!");
    location.reload();
    return;
  }
  player.x=nx;
  player.y=ny;
  if(nx===mother.x&&ny===mother.y){
    alert("ðŸ» Reached Mother!");
    location.reload();
    return;
  }
  render();
}

/* -------- TOUCH CONTROLS -------- */
document.querySelectorAll("#dpad button").forEach(btn=>{
  btn.addEventListener("touchstart",e=>{
    e.preventDefault();
    const dir=btn.dataset.dir;
    if(dir==="up")move(0,-1);
    if(dir==="down")move(0,1);
    if(dir==="left")move(-1,0);
    if(dir==="right")move(1,0);
  });
});

/* -------- RENDER -------- */
function render(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawMaze();
  drawSprites();
}
render();
</script>

</body>
</html>
